<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Energy Expressions · EnergyExpressions</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><script src="../assets/latex.js"></script></head><body><nav class="toc"><a href="../index.html"><img class="logo" src="../assets/logo.png" alt="EnergyExpressions logo"/></a><h1>EnergyExpressions</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><span class="toctext">Theory</span><ul><li><a class="toctext" href="../notation/">Notation</a></li><li class="current"><a class="toctext" href>Energy Expressions</a><ul class="internal"><li><a class="toctext" href="#Orthogonal-case,-Slater–Condon-rules-1">Orthogonal case, Slater–Condon rules</a></li><li><a class="toctext" href="#Non-orthogonal-case,-Löwdin-rules-1">Non-orthogonal case, Löwdin rules</a></li></ul></li><li><a class="toctext" href="../calculus_of_variations/">Calculus of Variations</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Theory</li><li><a href>Energy Expressions</a></li></ul><a class="edit-page" href="https://github.com/JuliaAtoms/EnergyExpressions.jl/blob/master/docs/src/energy_expressions.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Energy Expressions</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Energy-expressions-1" href="#Energy-expressions-1">Energy expressions</a></h1><p>The average energy of the system is given by</p><div>\[\begin{equation}
E_{\textrm{av}} \defd \matrixel{\Psi}{\Hamiltonian}{\Psi},
\end{equation}\]</div><p>where <span>$\Psi$</span> is the (multi-electron) wavefunction of the system and <span>$\Hamiltonian$</span> is the full Hamiltonian. A common approach is to approximate the wavefunction as a linear combination of <a href="https://en.wikipedia.org/wiki/Slater_determinant">Slater determinants</a>:</p><div>\[\begin{equation}
\Psi \approx \sum_K D_K\Phi_K,
\end{equation}\]</div><p>where each <span>$\Phi_K$</span> constitutes an anti-symmetrized product of one-particle spin-orbitals <span>$\chi_i$</span>. Depending on whether these spin-orbitals are chosen to be orthogonal or not, with respect to each other, the energy expression takes different forms.</p><p>Other choices for the expansion are possible, for instance <a href="https://en.wikipedia.org/wiki/Configuration_state_function">Configuration state functions</a>. The algebra for generating energy expressions from such objects is more involved, and is not implemented in this library.</p><p>The examples below are for atomic configurations, but the library is not fundamentally limited to this case.</p><h2><a class="nav-anchor" id="Orthogonal-case,-Slater–Condon-rules-1" href="#Orthogonal-case,-Slater–Condon-rules-1">Orthogonal case, Slater–Condon rules</a></h2><p>First, we find all configurations possible for two configurations of helium:</p><pre><code class="language-julia-repl">julia&gt; he = spin_configurations(c&quot;1s2&quot;)
1-element Array{Configuration{SpinOrbital{Orbital{Int64}}},1}:
 1s²

julia&gt; he_exc = spin_configurations(c&quot;1s 2p&quot;)
12-element Array{Configuration{SpinOrbital{Orbital{Int64}}},1}:
 1s₀α 2p₋₁α
 1s₀α 2p₋₁β
 1s₀α 2p₀α
 1s₀α 2p₀β
 1s₀α 2p₁α
 1s₀α 2p₁β
 1s₀β 2p₋₁α
 1s₀β 2p₋₁β
 1s₀β 2p₀α
 1s₀β 2p₀β
 1s₀β 2p₁α
 1s₀β 2p₁β</code></pre><h3><a class="nav-anchor" id="One-body-energy-term-1" href="#One-body-energy-term-1">One-body energy term</a></h3><p>The Slater–Condon rules state that the one-body energy expression between two configurations is</p><ul><li>in case the configurations are identical, <span>$\onebody{\Phi_A}{\Phi_B} = \onebody{i}{i}$</span>:<pre><code class="language-julia-repl">julia&gt; OneBodyEnergyExpression(he[1],he[1])
I(1s₀α) + I(1s₀β)</code></pre></li><li>in case the configurations differ by one orbital, <span>$\onebody{\Phi_A}{\Phi_B} = \onebody{i}{j}$</span>:<pre><code class="language-julia-repl">julia&gt; OneBodyEnergyExpression(he[1],he_exc[1])
I(1s₀β, 2p₋₁α)</code></pre></li><li>in case the configurations differ by more than one orbital, <span>$\onebody{\Phi_A}{\Phi_B} = 0$</span>:<pre><code class="language-julia-repl">julia&gt; OneBodyEnergyExpression(he_exc[1],he_exc[9])
0</code></pre></li></ul><p>We can easily generate the full one-body matrix:</p><pre><code class="language-julia-repl">julia&gt; one_body_hamiltonian_matrix(SpinOrbital, he_exc)
12×12 Array{OneBodyEnergyExpression{SpinOrbital,SpinOrbital},2}:
 I(1s₀α) + I(2p₋₁α)  I(2p₋₁α, 2p₋₁β)     I(2p₋₁α, 2p₀α)     I(2p₋₁α, 2p₀β)     I(2p₋₁α, 2p₁α)     I(2p₋₁α, 2p₁β)     I(1s₀α, 1s₀β)       0                   0                  0                  0                  0
 I(2p₋₁β, 2p₋₁α)     I(1s₀α) + I(2p₋₁β)  I(2p₋₁β, 2p₀α)     I(2p₋₁β, 2p₀β)     I(2p₋₁β, 2p₁α)     I(2p₋₁β, 2p₁β)     0                   I(1s₀α, 1s₀β)       0                  0                  0                  0
 I(2p₀α, 2p₋₁α)      I(2p₀α, 2p₋₁β)      I(1s₀α) + I(2p₀α)  I(2p₀α, 2p₀β)      I(2p₀α, 2p₁α)      I(2p₀α, 2p₁β)      0                   0                   I(1s₀α, 1s₀β)      0                  0                  0
 I(2p₀β, 2p₋₁α)      I(2p₀β, 2p₋₁β)      I(2p₀β, 2p₀α)      I(1s₀α) + I(2p₀β)  I(2p₀β, 2p₁α)      I(2p₀β, 2p₁β)      0                   0                   0                  I(1s₀α, 1s₀β)      0                  0
 I(2p₁α, 2p₋₁α)      I(2p₁α, 2p₋₁β)      I(2p₁α, 2p₀α)      I(2p₁α, 2p₀β)      I(1s₀α) + I(2p₁α)  I(2p₁α, 2p₁β)      0                   0                   0                  0                  I(1s₀α, 1s₀β)      0
 I(2p₁β, 2p₋₁α)      I(2p₁β, 2p₋₁β)      I(2p₁β, 2p₀α)      I(2p₁β, 2p₀β)      I(2p₁β, 2p₁α)      I(1s₀α) + I(2p₁β)  0                   0                   0                  0                  0                  I(1s₀α, 1s₀β)
 I(1s₀β, 1s₀α)       0                   0                  0                  0                  0                  I(1s₀β) + I(2p₋₁α)  I(2p₋₁α, 2p₋₁β)     I(2p₋₁α, 2p₀α)     I(2p₋₁α, 2p₀β)     I(2p₋₁α, 2p₁α)     I(2p₋₁α, 2p₁β)
 0                   I(1s₀β, 1s₀α)       0                  0                  0                  0                  I(2p₋₁β, 2p₋₁α)     I(1s₀β) + I(2p₋₁β)  I(2p₋₁β, 2p₀α)     I(2p₋₁β, 2p₀β)     I(2p₋₁β, 2p₁α)     I(2p₋₁β, 2p₁β)
 0                   0                   I(1s₀β, 1s₀α)      0                  0                  0                  I(2p₀α, 2p₋₁α)      I(2p₀α, 2p₋₁β)      I(1s₀β) + I(2p₀α)  I(2p₀α, 2p₀β)      I(2p₀α, 2p₁α)      I(2p₀α, 2p₁β)
 0                   0                   0                  I(1s₀β, 1s₀α)      0                  0                  I(2p₀β, 2p₋₁α)      I(2p₀β, 2p₋₁β)      I(2p₀β, 2p₀α)      I(1s₀β) + I(2p₀β)  I(2p₀β, 2p₁α)      I(2p₀β, 2p₁β)
 0                   0                   0                  0                  I(1s₀β, 1s₀α)      0                  I(2p₁α, 2p₋₁α)      I(2p₁α, 2p₋₁β)      I(2p₁α, 2p₀α)      I(2p₁α, 2p₀β)      I(1s₀β) + I(2p₁α)  I(2p₁α, 2p₁β)
 0                   0                   0                  0                  0                  I(1s₀β, 1s₀α)      I(2p₁β, 2p₋₁α)      I(2p₁β, 2p₋₁β)      I(2p₁β, 2p₀α)      I(2p₁β, 2p₀β)      I(2p₁β, 2p₁α)      I(1s₀β) + I(2p₁β)</code></pre><h3><a class="nav-anchor" id="Two-body-energy-term-1" href="#Two-body-energy-term-1">Two-body energy term</a></h3><p>Similar considerations apply for the two-body energy terms between two configurations. To make it more interesting, we consider lithium which has three electrons:</p><pre><code class="language-julia-repl">julia&gt; li = spin_configurations(c&quot;1s2 2s&quot;)
2-element Array{Configuration{SpinOrbital{Orbital{Int64}}},1}:
 1s² 2s₀α
 1s² 2s₀β

julia&gt; li_exc = spin_configurations(c&quot;1s 2s 2p&quot;)
24-element Array{Configuration{SpinOrbital{Orbital{Int64}}},1}:
 1s₀α 2s₀α 2p₋₁α
 1s₀α 2s₀α 2p₋₁β
 1s₀α 2s₀α 2p₀α
 1s₀α 2s₀α 2p₀β
 1s₀α 2s₀α 2p₁α
 1s₀α 2s₀α 2p₁β
 1s₀α 2s₀β 2p₋₁α
 1s₀α 2s₀β 2p₋₁β
 1s₀α 2s₀β 2p₀α
 1s₀α 2s₀β 2p₀β
 1s₀α 2s₀β 2p₁α
 1s₀α 2s₀β 2p₁β
 1s₀β 2s₀α 2p₋₁α
 1s₀β 2s₀α 2p₋₁β
 1s₀β 2s₀α 2p₀α
 1s₀β 2s₀α 2p₀β
 1s₀β 2s₀α 2p₁α
 1s₀β 2s₀α 2p₁β
 1s₀β 2s₀β 2p₋₁α
 1s₀β 2s₀β 2p₋₁β
 1s₀β 2s₀β 2p₀α
 1s₀β 2s₀β 2p₀β
 1s₀β 2s₀β 2p₁α
 1s₀β 2s₀β 2p₁β</code></pre><ul><li>in case the configurations are identical, <span>$\twobodydx{\Phi_A}{\Phi_B} = \twobodydx{ij}{ij}$</span>:<pre><code class="language-julia-repl">julia&gt; TwoBodyEnergyExpression(li[1],li[1])
[1s₀β 1s₀α||1s₀β 1s₀α] + [2s₀α 1s₀α||2s₀α 1s₀α] + [2s₀α 1s₀β||2s₀α 1s₀β]</code></pre></li><li>in case the configurations differ by one orbital, <span>$\twobodydx{\Phi_A}{\Phi_B} = \twobodydx{ik}{jk}$</span>:<pre><code class="language-julia-repl">julia&gt; TwoBodyEnergyExpression(li[1],li[2])
[2s₀α 1s₀α||2s₀β 1s₀α] + [2s₀α 1s₀β||2s₀β 1s₀β]</code></pre></li><li>in case the configurations differ by two orbitals, <span>$\twobodydx{\Phi_A}{\Phi_B} = \twobodydx{ij}{kl}$</span>:<pre><code class="language-julia-repl">julia&gt; TwoBodyEnergyExpression(li[1],li_exc[end])
[1s₀α 2s₀α||2s₀β 2p₁β]</code></pre></li><li>in case the configurations differ by more than two orbital, <span>$\twobodydx{\Phi_A}{\Phi_B} = 0$</span>:<pre><code class="language-julia-repl">julia&gt; TwoBodyEnergyExpression(li_exc[1],li_exc[end])
0</code></pre></li></ul><p>Again, we can generate the full two-body matrix:</p><pre><code class="language-julia-repl">julia&gt; two_body_hamiltonian_matrix(SpinOrbital, li_exc)
24×24 Array{TwoBodyEnergyExpression{SpinOrbital,SpinOrbital,SpinOrbital,SpinOrbital},2}:
 [2s₀α 1s₀α||2s₀α 1s₀α] + … + [2p₋₁α 2s₀α||2p₋₁α 2s₀α]  [2p₋₁α 1s₀α||2p₋₁β 1s₀α] + [2p₋₁α 2s₀α||2p₋₁β 2s₀α]    …  0
 [2p₋₁β 1s₀α||2p₋₁α 1s₀α] + [2p₋₁β 2s₀α||2p₋₁α 2s₀α]    [2s₀α 1s₀α||2s₀α 1s₀α] + … + [2p₋₁β 2s₀α||2p₋₁β 2s₀α]     0
 [2p₀α 1s₀α||2p₋₁α 1s₀α] + [2p₀α 2s₀α||2p₋₁α 2s₀α]      [2p₀α 1s₀α||2p₋₁β 1s₀α] + [2p₀α 2s₀α||2p₋₁β 2s₀α]         0
 [2p₀β 1s₀α||2p₋₁α 1s₀α] + [2p₀β 2s₀α||2p₋₁α 2s₀α]      [2p₀β 1s₀α||2p₋₁β 1s₀α] + [2p₀β 2s₀α||2p₋₁β 2s₀α]         0
 [2p₁α 1s₀α||2p₋₁α 1s₀α] + [2p₁α 2s₀α||2p₋₁α 2s₀α]      [2p₁α 1s₀α||2p₋₁β 1s₀α] + [2p₁α 2s₀α||2p₋₁β 2s₀α]         0
 [2p₁β 1s₀α||2p₋₁α 1s₀α] + [2p₁β 2s₀α||2p₋₁α 2s₀α]      [2p₁β 1s₀α||2p₋₁β 1s₀α] + [2p₁β 2s₀α||2p₋₁β 2s₀α]      …  [1s₀α 2s₀α||1s₀β 2s₀β]
 [2s₀β 1s₀α||2s₀α 1s₀α] + [2s₀β 2p₋₁α||2s₀α 2p₋₁α]      [2s₀β 2p₋₁α||2s₀α 2p₋₁β]                                  [1s₀α 2p₋₁α||1s₀β 2p₁β]
 [2s₀β 2p₋₁β||2s₀α 2p₋₁α]                               [2s₀β 1s₀α||2s₀α 1s₀α] + [2s₀β 2p₋₁β||2s₀α 2p₋₁β]         [1s₀α 2p₋₁β||1s₀β 2p₁β]
 [2s₀β 2p₀α||2s₀α 2p₋₁α]                                [2s₀β 2p₀α||2s₀α 2p₋₁β]                                   [1s₀α 2p₀α||1s₀β 2p₁β]
 [2s₀β 2p₀β||2s₀α 2p₋₁α]                                [2s₀β 2p₀β||2s₀α 2p₋₁β]                                   [1s₀α 2p₀β||1s₀β 2p₁β]
 [2s₀β 2p₁α||2s₀α 2p₋₁α]                                [2s₀β 2p₁α||2s₀α 2p₋₁β]                                …  [1s₀α 2p₁α||1s₀β 2p₁β]
 [2s₀β 2p₁β||2s₀α 2p₋₁α]                                [2s₀β 2p₁β||2s₀α 2p₋₁β]                                   [1s₀α 2s₀β||1s₀β 2s₀β] + [1s₀α 2p₁β||1s₀β 2p₁β]
 [1s₀β 2s₀α||1s₀α 2s₀α] + [1s₀β 2p₋₁α||1s₀α 2p₋₁α]      [1s₀β 2p₋₁α||1s₀α 2p₋₁β]                                  [2s₀α 2p₋₁α||2s₀β 2p₁β]
 [1s₀β 2p₋₁β||1s₀α 2p₋₁α]                               [1s₀β 2s₀α||1s₀α 2s₀α] + [1s₀β 2p₋₁β||1s₀α 2p₋₁β]         [2s₀α 2p₋₁β||2s₀β 2p₁β]
 [1s₀β 2p₀α||1s₀α 2p₋₁α]                                [1s₀β 2p₀α||1s₀α 2p₋₁β]                                   [2s₀α 2p₀α||2s₀β 2p₁β]
 [1s₀β 2p₀β||1s₀α 2p₋₁α]                                [1s₀β 2p₀β||1s₀α 2p₋₁β]                                …  [2s₀α 2p₀β||2s₀β 2p₁β]
 [1s₀β 2p₁α||1s₀α 2p₋₁α]                                [1s₀β 2p₁α||1s₀α 2p₋₁β]                                   [2s₀α 2p₁α||2s₀β 2p₁β]
 [1s₀β 2p₁β||1s₀α 2p₋₁α]                                [1s₀β 2p₁β||1s₀α 2p₋₁β]                                   [2s₀α 1s₀β||2s₀β 1s₀β] + [2s₀α 2p₁β||2s₀β 2p₁β]
 [1s₀β 2s₀β||1s₀α 2s₀α]                                 0                                                         [2p₋₁α 1s₀β||2p₁β 1s₀β] + [2p₋₁α 2s₀β||2p₁β 2s₀β]
 0                                                      [1s₀β 2s₀β||1s₀α 2s₀α]                                    [2p₋₁β 1s₀β||2p₁β 1s₀β] + [2p₋₁β 2s₀β||2p₁β 2s₀β]
 0                                                      0                                                      …  [2p₀α 1s₀β||2p₁β 1s₀β] + [2p₀α 2s₀β||2p₁β 2s₀β]
 0                                                      0                                                         [2p₀β 1s₀β||2p₁β 1s₀β] + [2p₀β 2s₀β||2p₁β 2s₀β]
 0                                                      0                                                         [2p₁α 1s₀β||2p₁β 1s₀β] + [2p₁α 2s₀β||2p₁β 2s₀β]
 0                                                      0
 [2s₀β 1s₀β||2s₀β 1s₀β] + … + [2p₁β 2s₀β||2p₁β 2s₀β]</code></pre><h2><a class="nav-anchor" id="Non-orthogonal-case,-Löwdin-rules-1" href="#Non-orthogonal-case,-Löwdin-rules-1">Non-orthogonal case, Löwdin rules</a></h2><p>This case is more complex and not yet fully implemented in EnergyExpressions.jl</p><h3><a class="nav-anchor" id="One-body-energy-term-2" href="#One-body-energy-term-2">One-body energy term</a></h3><div>\[\onebody{\Phi_A}{\Phi_B} = (-)^{i+j}\onebody{i}{j}D^{AB}_{ji},\]</div><p>where <span>$D^{AB}_{ji}$</span> is the determinant minor.</p><p>The implementation is only correct for two-electron configurations at the moment:</p><pre><code class="language-julia-repl">julia&gt; OneBodyEnergyExpression{SpinOrbital,SpinOrbital}(he[1],he[1],orthogonal=false)
I(1s₀α) - I(1s₀α, 1s₀β) - I(1s₀β, 1s₀α) + I(1s₀β)</code></pre><h3><a class="nav-anchor" id="References-1" href="#References-1">References</a></h3><ul><li><p>Per-Olov Löwdin (1955). Quantum Theory of Many-Particle Systems. I. Physical Interpretations by Means of Density Matrices, Natural Spin-Orbitals, and Convergence Problems in the Method of Configurational Interaction. Physical Review, 97(6), 1474–1489. <a href="http://dx.doi.org/10.1103/physrev.97.1474">10.1103/physrev.97.1474</a></p></li><li><p>Per-Olov Löwdin (1955). Quantum Theory of Many-Particle Systems. II. Study of the Ordinary Hartree-Fock Approximation. Physical Review, 97(6), 1490–1508. <a href="http://dx.doi.org/10.1103/physrev.97.1490">10.1103/physrev.97.1490</a></p></li><li><p>Per-Olov Löwdin (1955). Quantum Theory of Many-Particle Systems. III. Extension of the Hartree-Fock Scheme to Include Degenerate Systems and Correlation Effects. Physical Review, 97(6), 1509–1520. <a href="http://dx.doi.org/10.1103/physrev.97.1509">10.1103/physrev.97.1509</a></p></li></ul><footer><hr/><a class="previous" href="../notation/"><span class="direction">Previous</span><span class="title">Notation</span></a><a class="next" href="../calculus_of_variations/"><span class="direction">Next</span><span class="title">Calculus of Variations</span></a></footer></article></body></html>
